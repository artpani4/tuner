# Tuner

[![deno.land/x/tuner](https://shield.deno.dev/x/tuner)](https://deno.land/x/tuner) [![JSR Score](https://jsr.io/badges/@artpani/tuner/score)](https://jsr.io/@artpani/tuner)

Tuner - –º–æ–¥—É–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞. –î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –≤–∏–¥–µ¬†**.ts**¬†—Ñ–∞–π–ª–∞ —Å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–º –æ–±—ä–µ–∫—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ¬†_env_¬†–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –ø–æ–ª–µ–π –∫–æ–Ω—Ñ–∏–≥–∞. –ö–æ–Ω—Ñ–∏–≥–∏ –º–æ–≥—É—Ç –æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é, –Ω–∞—Å–ª–µ–¥—É—è—Å—å –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—è—Å—å –¥–æ—á–µ—Ä–Ω–∏–º–∏.

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [Tuner](#tuner)
  - [–û–≥–ª–∞–≤–ª–µ–Ω–∏–µ](#–æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ)
  - [–ü—Ä–æ—Å—Ç–µ–π—à–∏–π –∫–æ–Ω—Ñ–∏–≥](#–ø—Ä–æ—Å—Ç–µ–π—à–∏–π-–∫–æ–Ω—Ñ–∏–≥)
  - [–ö–æ–Ω—Ñ–∏–≥ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º env-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö](#–∫–æ–Ω—Ñ–∏–≥-—Å-–æ–ø–∏—Å–∞–Ω–∏–µ–º-env-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)
  - [–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤](#–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ-–∫–æ–Ω—Ñ–∏–≥–æ–≤)
  - [–û–ø—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ](#–æ–ø—Ü–∏–∏-–ø—Ä–∏-–∑–∞–≥—Ä—É–∑–∫–µ)
  - [üÜï –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CLI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π](#-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-cli-–¥–ª—è-–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π)

## –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –∫–æ–Ω—Ñ–∏–≥

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –∫–æ–Ω—Ñ–∏–≥ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø–∏—Å–∞–Ω —Ç–∞–∫:

```tsx
// ./config/myConfig.tuner.ts
import Tuner from 'jsr:@artpani/tuner';

export default Tuner.tune(
  {
    data: {
      field1: 'value1',
      field2: 100,
      field3: true,
      field4: ['–º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ', '—É–¥–æ–±–Ω–æ', '–Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?'],
    },
  },
);

export default myCfg;
export type MyCFGType = typeof myCfg;
```

> –§—É–Ω–∫—Ü–∏—è _tune_ –∑–∞–±–æ—Ç–ª–∏–≤–æ –ø–æ–¥—Å–∫–∞–∂–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ–∂–∏–¥–∞–µ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞

–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–∞–∫:

```tsx
// ./main.ts
import Tuner from 'jsr:@artpani/tuner';
import { MyCFGType } from '../config/myConfig.tuner.ts';
const cfg = await Tuner.use.loadConfig<MyCFGType>({
  configDirPath: 'config',
});
console.log(cfg.data.field2); // 100
```

__–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–ª–∏—á–∏–µ _env_ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π _CONFIG_, –µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥–∞ –¥–æ _.tuner.ts,__ –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ myConfig._

```bash
CONFIG=myConfig deno run --allow-all main.ts
```

## –ö–æ–Ω—Ñ–∏–≥ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º env-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–í Tuner –∏–º–µ–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–ø–∏—Å–∞—Ç—å —Ç–∏–ø—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–∏ –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏:

- –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
- –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ –ª–µ—Ç—É

–ù–∞–ø—Ä–∏–º–µ—Ä, —Ç–∞–∫:

```tsx
// ./config/myConfig.tuner.ts
import Tuner from 'jsr:@artpani/tuner';
export default Tuner.tune(
  {
    env: {
      // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
      env1: Tuner.Env.getString.orDefault('defalut value1'),
      env2: Tuner.Env.getNumber.orDefault(100),
      env3: Tuner.Env.getBoolean.orDefault(true),
      // –ü—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Å—É—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π(–±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ç–∏–ø –∑–Ω–∞—á–µ–Ω–∏—è + undefined)
      env4: Tuner.Env.getString.orNothing(),
      env5: Tuner.Env.getNumber.orNothing(),
      env6: Tuner.Env.getBoolean.orNothing(),
      // –ó–∞–≤–µ—Ä—à–µ–Ω–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
      env7: Tuner.Env.getString.orExit(
        '—Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ, –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ',
      ),
      env8: Tuner.Env.getNumber.orExit(
        '–≤—ã–≤–µ–¥–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º',
      ),
      env9: Tuner.Env.getBoolean.orExit(),
      // –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
      env10: Tuner.Env.getString.orThrow(new Error('–æ—à–∏–±–∫–∞')),
      env11: Tuner.Env.getNumber.orThrow(new Error()),
      env12: Tuner.Env.getBoolean.orThrow(new Error()),
      // –í—ã—á–∏—Å–ª–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã—Ö –ø–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–º—É –∫–æ–ª–±—ç–∫—É
      //(–º–æ–∂–µ—Ç –±—ã—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å –¥–∏—Å–∫–∞ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä)
      env13: Tuner.Env.getString.orCompute(() => 'computed value1'),
      env14: Tuner.Env.getNumber.orAsyncCompute(() =>
        new Promise(() => 100)
      ),
    },
    data: {
      field1: 'value1',
      field2: 100,
      field3: true,
      field4: ['–º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ', '—É–¥–æ–±–Ω–æ', '–Ω–µ –ø—Ä–∞–≤–¥–∞ –ª–∏?'],
    },
  },
);
```

> **–†–∞–∑—É–º–µ–µ—Ç—Å—è, –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —É–∫–∞–∑–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ-–ø—Ä–∏–º–∏—Ç–∏–≤, –≤—Ä–æ–¥–µ env1: 100**

## –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤

Tuner –ø–æ–∑–≤–æ–ª—è–µ—Ç ‚Äú—Å–æ–±—Ä–∞—Ç—å‚Äù –∫–æ–Ω—Ñ–∏–≥, –∏—Å–ø–æ–ª—å–∑—É—è –¥—Ä—É–≥–∏–µ –∫–æ–Ω—Ñ–∏–≥–∏, –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤—ã—Å—Ç—Ä–æ–∏—Ç—å –∏–∑ –Ω–∏—Ö —Ü–µ–ø–æ—á–∫—É:

- –¢–µ–∫—É—â–∏–π –∫–æ–Ω—Ñ–∏–≥ –¥–æ–ø–æ–ª–Ω–∏—Ç—Å—è –≤—Å–µ–º–∏ –ø–æ–ª—è–º–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ, –ø—Ä–∏ —ç—Ç–æ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è
- –¢–µ–∫—É—â–∏–π –∫–æ–Ω—Ñ–∏–≥ –¥–æ–ø–æ–ª–Ω–∏—Ç—Å—è –≤—Å–µ–º–∏ –ø–æ–ª—è–º–∏ –¥–æ—á–µ—Ä–Ω–µ–≥–æ, –ø—Ä–∏ —ç—Ç–æ–º —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ –ø–æ–ª—è –±—É–¥—É—Ç –ø–µ—Ä–µ–ø–∏—Å–∞–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏–∑ –¥–æ—á–µ—Ä–Ω–µ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞
- –ó–Ω–∞—á–µ–Ω–∏—è-—Ñ—É–∫–Ω—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è env-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–∞–∫–∂–µ –ø–æ–¥—á–∏–Ω—è—é—Ç—Å—è —ç—Ç–∏–º –ø—Ä–∞–≤–∏–ª–∞–º

![–ü—Ä–∏–º–µ—Ä –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è](https://artpani.sirv.com/Images/projects/tuner/cascade.png)

> –ü—Ä–∏ —ç—Ç–æ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–Ω—Ñ–∏–≥—É –í –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –ê –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ.

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:

```tsx
// config/develop.tuner.ts
import Tuner from 'jsr:@artpani/tuner';
import { ACfgType } from './a.tuner.ts';

const developCfg = Tuner.tune({
  parent: Tuner.Load.local.configDir<ACfgType>('a.tuner.ts'),
  data: {
    a: 300,
    b: 301,
  },
});

export default developCfg;
export type DevelopCFGType = typeof developCfg;

// config/base.tuner.ts
import Tuner from 'jsr:@artpani/tuner';

const baseCfg = Tuner.tune({
  data: {
    a: 400,
    b: 401,
    c: 402,
  },
});

export default baseCfg;
export type BaseCFGType = typeof baseCfg;

// config/a.tuner.ts
import Tuner from 'jsr:@artpani/tuner';
import { BaseCFGType } from './base.tuner.ts';

const aCfg = Tuner.tune({
  parent: Tuner.Load.local.configDir<BaseCFGType>('base.tuner.ts'),
  child: Tuner.Load.local.configDir('b.tuner.ts'),
  data: {
    b: 200,
    e: 201,
  },
});

export default aCfg;
export type ACfgType = typeof aCfg;

// config/b.tuner.ts
import Tuner from 'jsr:@artpani/tuner';

const bCfg = Tuner.tune({
  data: {
    a: 100,
    d: 101,
  },
});

export default bCfg;
export type BCfgType = typeof bCfg;

// main.ts
import { DevelopCFGType } from './config/develop.tuner.ts';
import Tuner from 'jsr:@artpani/tuner';

const config = await Tuner.use.loadConfig<DevelopCFGType>({
  configDirPath: './config',
});

console.log(config.data);
// { a: 300, b: 301, c: 402, e: 201, d: 101 }
```

## –û–ø—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

–ü—Ä–∏ –≤—ã–∑–æ–≤–µ loadConfig, –ø–µ—Ä–µ–¥–∞–π—Ç–µ –æ–±—ä–µ–∫—Ç —Å –æ–ø—Ü–∏—è–º–∏, —á—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π:

- _configDirPath_: –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã. **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è (./config)**. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –æ–ø—Ü–∏—é, –µ—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ.

## üÜï –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CLI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CLI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä—è–º–æ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:

```bash
deno run --allow-all https://raw.githubusercontent.com/artpani4/tuner/main/cli/mod.ts
```
